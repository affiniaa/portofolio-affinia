<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Portfolios Form</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .portfolio-section {
      border: 1px solid #ced4da;
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 30px;
      background-color: #f8f9fa;
    }
  </style>
</head>
<body>
<div class="container mt-5">
  <h2 class="mb-4">Input Portfolio Data</h2>
  <form id="portfolioForm">
    <div id="portfolioContainer"></div>
    <button type="button" class="btn btn-secondary mb-3" onclick="addPortfolio()">+ Add Portfolio</button>
    <br>
    <button type="submit" class="btn btn-primary">Submit Data</button>
  </form>

  <hr class="my-5">
  <h4>Submitted Data Preview:</h4>
  <pre id="output"></pre>
</div>

<script>
  let portfolioIndex = 0;

  function addPortfolio() {
    const container = document.getElementById('portfolioContainer');

    const section = document.createElement('div');
    section.classList.add('portfolio-section');
    section.setAttribute('data-index', portfolioIndex);
    section.innerHTML = `
      <h5>Portfolio #${portfolioIndex + 1}</h5>
      <div class="mb-3">
        <label>Portfolio ID</label>
        <input type="text" name="portfolio_id_${portfolioIndex}" class="form-control">
      </div>
      <div class="mb-3">
        <label>Info</label>
        <input type="text" name="info_${portfolioIndex}" class="form-control">
      </div>
      <div class="mb-3">
        <label>Image Portfolio Source</label>
        <input type="text" name="img_portfolio_src_${portfolioIndex}" class="form-control">
      </div>
      <div class="mb-3">
        <label>Project</label>
        <input type="text" name="project_${portfolioIndex}" class="form-control">
      </div>
      <div class="mb-3">
        <label>Description</label>
        <textarea name="description_${portfolioIndex}" class="form-control" rows="2"></textarea>
      </div>
      <div class="mb-3">
        <label>Project Responsibilities</label>
        <div id="responsibilities_${portfolioIndex}">
          <input type="text" name="responsibility_${portfolioIndex}[]" class="form-control mb-2" placeholder="Enter responsibility">
        </div>
        <button type="button" class="btn btn-sm btn-outline-secondary" onclick="addResponsibility(${portfolioIndex})">+ Add Responsibility</button>
      </div>
      <button type="button" class="btn btn-sm btn-danger" onclick="removePortfolio(this)">Remove Portfolio</button>
    `;
    container.appendChild(section);
    portfolioIndex++;
  }

  function addResponsibility(index) {
    const div = document.getElementById(`responsibilities_${index}`);
    const input = document.createElement('input');
    input.type = 'text';
    input.name = `responsibility_${index}[]`;
    input.classList.add('form-control', 'mb-2');
    input.placeholder = 'Enter responsibility';
    div.appendChild(input);
  }

  function removePortfolio(button) {
    button.closest('.portfolio-section').remove();
  }

  document.getElementById('portfolioForm').addEventListener('submit', function (e) {
    e.preventDefault();

    const result = [];
    const sections = document.querySelectorAll('.portfolio-section');

    sections.forEach(section => {
      const index = section.getAttribute('data-index');
      const portfolio = {
        portfolio_id: document.querySelector(`[name="portfolio_id_${index}"]`).value,
        info: document.querySelector(`[name="info_${index}"]`).value,
        img_portfolio_src: document.querySelector(`[name="img_portfolio_src_${index}"]`).value,
        project: document.querySelector(`[name="project_${index}"]`).value,
        description: document.querySelector(`[name="description_${index}"]`).value,
        project_responsibilities: Array.from(document.querySelectorAll(`[name="responsibility_${index}[]"]`)).map(input => input.value)
      };
      result.push(portfolio);
    });

    document.getElementById('output').textContent = JSON.stringify(result, null, 2);
  });

  // Tambahkan satu form awal saat load
  window.onload = addPortfolio;
</script>
</body>
</html>
